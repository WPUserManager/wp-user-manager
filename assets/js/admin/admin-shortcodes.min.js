/*! WP User Manager - v2.9
 * https://wpusermanager.com
 * Copyright (c) 2023; * Licensed GPLv2+ */
var jq=jQuery.noConflict(),wpumShortcode,wpumButton,render_continue_button_title_field=function(){var a=jq(".mce-txt",".mce-wpum-display-style").text(),b=["- Select -","All Fields"];-1!==jq.inArray(a,b)?jq(".mce-wpum-continue-button-title").closest(".mce-container").hide():jq(".mce-wpum-continue-button-title").closest(".mce-container").show()},wpumForm={open:function(a){var b=tinymce.get(a);if(b){var c,d,e,f,g;c={action:"wpum_shortcode",shortcode:wpumShortcode},jq.post(ajaxurl,c,function(a){if(!a.body)return void console.error("Bad AJAX response!");if(0===a.body.length)return window.send_to_editor("["+a.shortcode+"][/"+a.shortcode+"]"),void wpumForm.destroy();jq.each(a.body,function(b,c){"display_style"===c.name&&(a.body[b].onselect=function(){render_continue_button_title_field()})});var c={title:a.title,body:a.body,classes:"wpum-popup",minWidth:320,buttons:[{text:a.ok,classes:"primary wpum-primary",onclick:function(){g=b.windowManager.getWindows()[0],e=wpumShortcodes[wpumShortcode],f=!0;for(var a in e)if(e.hasOwnProperty(a)&&void 0!==(d=g.find("#"+a)[0])&&""===d.state.data.value){f=!1,alert(e[a]);break}f&&g.submit()}},{text:a.close,onclick:"close"}],onsubmit:function(b){var c="";for(var d in b.data)b.data.hasOwnProperty(d)&&""!==b.data[d]&&(c+=" "+d+'="'+b.data[d]+'"');window.send_to_editor("["+a.shortcode+c+"][/"+a.shortcode+"]")},onclose:function(){wpumForm.destroy()},onopen:function(){console.log(a),render_continue_button_title_field()}};a.ok.constructor===Array&&(c.buttons[0].text=a.ok[0],c.buttons[0].onclick="close",delete c.buttons[1]),b.windowManager.open(c)})}},destroy:function(){var a=jq("#wpumTemp");a.length&&(tinymce.get("wpumTemp").remove(),a.remove())}};jq(function(a){var b=function(){wpumButton.addClass("active").parent().find(".wpum-menu").show()},c=function(){void 0!==wpumButton&&wpumButton.removeClass("active").parent().find(".wpum-menu").hide()};a(document).on("click",function(b){a(b.target).closest(".wpum-wrap").length||c()}),a(document).on("click",".wpum-button",function(d){d.preventDefault(),wpumButton=a(this),wpumButton.hasClass("active")?c():b()}),a(document).on("click",".wpum-shortcode",function(b){b.preventDefault(),wpumShortcode=a(this).attr("data-shortcode"),wpumShortcode?(tinymce.get(window.wpActiveEditor)?tinymce.execCommand("WPUM_Shortcode"):(a("#wpumTemp").length||(a("body").append('<textarea id="wpumTemp" style="display: none;" />'),tinymce.init({mode:"exact",elements:"wpumTemp",plugins:["wpum_shortcode","wplink"]})),setTimeout(function(){tinymce.execCommand("WPUM_Shortcode")},200)),setTimeout(function(){c()},100)):console.warn("That is not a valid shortcode link.")})});